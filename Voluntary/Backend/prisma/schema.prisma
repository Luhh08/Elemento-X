// Aqui iremos controlar todas as configurações do banco de dados
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                 String   @id @default(auto()) @map("_id") @db.ObjectId
  nome               String
  usuario            String   @unique
  email              String   @unique
  cpf                String   @unique
  senha              String

  // Validação e segurança
  validacao          Boolean  @default(false)
  validacaoToken     String?
  resetToken         String?
  resetTokenExpires  DateTime?

  // Campos extras de perfil
  descricao          String?         
  competencias       String[]        
  preferenciaHorario String[]        
  emailcontato       String?         
  telefonecontato    String?         

  // URLs de imagens
  bannerUrl          String?   
  fotoUrl            String?   

}

model Empresa {
  id               String  @id @default(auto()) @map("_id") @db.ObjectId
  razao_social     String
  email            String  @unique
  cnpj             String  @unique
  telefone_empresa String  @unique
  cep              String
  endereco         String
  senha            String

  // Validação e segurança
  validacao          Boolean  @default(false)
  validacaoToken     String?
  resetToken         String?
  resetTokenExpires  DateTime?

  // Relação com representantes
  representantes     RepresentanteLegal[]

  // Perfil público
  usuario          String?  @unique
  descricao         String?                       
  tags              String[] @default([])         
  bannerUrl         String?                       
  logoUrl           String?      
  emailcontato      String?
  telefonecontato   String?    
  vaga              Vaga[]                              

}

model RepresentanteLegal {
  id                     String   @id @default(auto()) @map("_id") @db.ObjectId
  nome                   String
  cpf                    String   @unique
  cargo                  String
  email_representante    String   @unique
  telefone_representante String   @unique
  empresaId              String?  @db.ObjectId
  empresa Empresa? @relation(fields: [empresaId], references: [id], onDelete: Cascade)

}

model Administrador {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  usuario  String 
  senha    String
}

enum VagaStatus {
  ABERTA
  INSCRICOES_FINALIZADAS
  ANDAMENTO
  FINALIZADA
}

model Vaga{

  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  empresaId   String     @db.ObjectId
  titulo      String
  descricao   String
  tags        String[]
  local       String
  turno       String[]   
  status      VagaStatus @default(ABERTA)
  dataInicio  DateTime?
  dataFim     DateTime?
  imagens     String[]   
  aplicacoes  Int        @default(0)
  empresa    Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)

}